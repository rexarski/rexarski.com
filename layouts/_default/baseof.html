<!DOCTYPE html>
<html lang="{{ with .Site.LanguageCode }}{{ . }}{{ else }}en-US{{ end }}">

<head>
    <script defer src="https://us.umami.is/script.js" data-website-id="13230151-96f3-4625-bcd1-04f0046fb02d"></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {{- partial "favicon.html" . -}}
    <title>
        {{- block "title" . }}{{ with .Title }}{{ . }} | {{ end }}{{
        .Site.Title }}{{- end }}
    </title>

    {{- partial "seo_tags.html" . -}}
    <meta name="referrer" content="no-referrer-when-downgrade" />

    {{ with .OutputFormats.Get "rss" -}} {{ printf `
    <link rel="%s" type="%s" href="%s" title="%s" />
    ` .Rel .MediaType.Type .Permalink $.Site.Title | safeHTML }} {{ end -}}
    {{- partial "style.html" . -}}

    <!-- A partial to be overwritten by the user.
        Simply place a custom_head.html into
        your local /layouts/partials-directory -->
    {{- partial "custom_head.html" . -}}
</head>

<body>
    <script>
    (function() {
        var s = localStorage.getItem('darkMode');
        var body = document.body;
        body.classList.remove('theme-dark', 'force-light', 'force-dark');
        if (s === 'force-light') body.classList.add('force-light');
        else if (s === 'force-dark') body.classList.add('force-dark', 'theme-dark');
        else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) body.classList.add('theme-dark');
    })();
    </script>
    <header>{{- partial "header.html" . -}}</header>
    <main class="{{ if .IsHome }}home{{ end }}">{{- block "main" . }}{{- end }}</main>
    <footer>{{- partial "footer.html" . -}}</footer>

    <script>
    (function() {
        function initHolographic() {
            document.querySelectorAll('.infobox-image-container').forEach(function(el) {
                if (el.dataset.holoInit) return;
                el.dataset.holoInit = '1';
                el.addEventListener('mousemove', function(e) {
                    var rect = el.getBoundingClientRect();
                    var cx = rect.left + rect.width / 2;
                    var cy = rect.top + rect.height / 2;
                    var angle = Math.atan2(e.clientY - cy, e.clientX - cx);
                    el.style.setProperty('--holo-angle', (angle * 180 / Math.PI + 90) + 'deg');
                });
                el.addEventListener('mouseleave', function() {
                    el.style.removeProperty('--holo-angle');
                });
            });
        }
        if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', initHolographic);
        else initHolographic();
    })();
    </script>

    <!-- A partial to be overwritten by the user.
        Simply place a custom_body.html into
        your local /layouts/partials-directory -->
    {{- partial "custom_body.html" . -}}
</body>

</html>