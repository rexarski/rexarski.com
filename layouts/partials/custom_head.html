<!-- <script>
    MathJax = {
        tex: {
            inlineMath: [
                ['$', '$'],
                ['\\(', '\\)'],
            ],
        },
        svg: {
            fontCache: 'global',
        },
    };
</script>
<script
    id="MathJax-script"
    async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script> -->

<script>
    // Dark mode functionality with two states: auto vs opposite
    function toggleDarkMode() {
        const body = document.body;
        const toggle = document.getElementById('dark-mode-toggle');
        
        // Remove any existing mode classes
        body.classList.remove('force-light', 'force-dark');
        
        const currentMode = localStorage.getItem('darkMode');
        const systemPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (!currentMode || currentMode === 'auto') {
            // Currently auto, switch to opposite of system preference
            if (systemPrefersDark) {
                // System is dark, force light
                body.classList.add('force-light');
                toggle.textContent = '○';
                localStorage.setItem('darkMode', 'force-light');
            } else {
                // System is light, force dark
                body.classList.add('force-dark');
                toggle.textContent = '●';
                localStorage.setItem('darkMode', 'force-dark');
            }
        } else {
            // Currently forced, switch back to auto
            toggle.textContent = '●';
            localStorage.setItem('darkMode', 'auto');
        }
    }

    // Initialize dark mode on page load
    document.addEventListener('DOMContentLoaded', function() {
        const savedMode = localStorage.getItem('darkMode');
        const toggle = document.getElementById('dark-mode-toggle');
        const body = document.body;
        
        // Remove any existing mode classes first
        body.classList.remove('force-light', 'force-dark');
        
        if (savedMode === 'force-light') {
            body.classList.add('force-light');
            toggle.textContent = '○';
        } else if (savedMode === 'force-dark') {
            body.classList.add('force-dark');
            toggle.textContent = '●';
        } else {
            // Auto mode - always show moon icon
            toggle.textContent = '●';
            localStorage.setItem('darkMode', 'auto');
        }
        
        // Listen for system theme changes in auto mode
        if (window.matchMedia) {
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
                const currentMode = localStorage.getItem('darkMode');
                if (currentMode === 'auto') {
                    // In auto mode, icon stays the same but theme changes automatically
                    // No need to update icon since it always shows moon in auto mode
                }
            });
        }
    });
</script>
