<!--Available categories: book, movie, tv, podcast, music, game, performance-->
{{ $category := .Get 0 }}
<!--Available types: wishlist, progress, complete-->
{{ $type := .Get 1 }} {{ if eq $type "" }} {{ $type = "complete" }} {{ end }} {{
$url := printf "https://neodbworker.rexarski.workers.dev/%s?type=%s" $category
$type }} {{ $response := resources.GetRemote $url }} {{ if $response }} {{ $json
:= $response | transform.Unmarshal }}

<div class="item-gallery">
    {{ range $value := first 10 $json.data }} {{ $item := $value.item }}
    <div class="item-card">
        <a
            class="item-card-upper"
            href="{{ $item.id }}"
            target="_blank"
            rel="noreferrer"
        >
            <img
                class="item-cover"
                src="{{ .item.cover_image_url }}"
                alt="{{ .item.display_title }}"
            />
        </a>
        {{ if .item.rating }}
        <div class="rate">
            <span><b>{{ .item.rating }}</b>ðŸŒŸ</span>
            <br />
            <span class="rating-count"> {{.item.rating_count}}äººè¯„åˆ†</span>
        </div>
        {{ else}}
        <div class="rate">
            <span>æš‚æ— ðŸŒŸ</span>
            <br />
            <span class="rating-count"> {{.item.rating_count}}äººè¯„åˆ†</span>
        </div>
        {{ end }}
        <h3 class="item-title">{{ .item.display_title }}</h3>
    </div>
    {{ end }}
</div>
{{ end }}

<style>
    .item-gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
        gap: 1.5rem;
        padding: 1rem 0;
    }

    .item-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        transition: opacity 0.2s ease;
    }

    .item-card:hover {
        opacity: 0.8;
    }

    .item-cover {
        width: 90px;
        aspect-ratio: 2/3;
        object-fit: cover;
        border-radius: 4px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .rate {
        margin-top: 0.5rem;
        text-align: center;
        font-size: 0.8rem;
        color: #666;
    }

    .rating-count {
        font-size: 0.7rem;
        color: #999;
    }

    .item-title {
        display: block;
        font-size: 0.8rem;
        color: #333;
        text-align: center;
        margin-top: 0.5rem;
        max-width: 90px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    @media (max-width: 600px) {
        .item-gallery {
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 1rem;
        }

        .item-cover {
            width: 80px;
        }

        .item-title {
            max-width: 80px;
        }
    }
</style>
